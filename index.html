<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Operations Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üì¶ E-Commerce Operations Dashboard</h1>
            <button id="generateExcelBtn" class="btn-generate">üìä Generate Excel Report</button>
            <div id="statusIndicator" class="status-indicator"></div>
        </header>

        <!-- Bash Query Interface -->
        <section class="bash-query">
            <h2>üîç Bash Query Interface</h2>
            <div class="query-input-group">
                <input type="text" id="queryInput" placeholder="Enter your query (e.g., Show customer order status)" />
                <button id="submitQuery">Submit Query</button>
            </div>
            <div id="queryResponse" class="query-response"></div>
        </section>

        <!-- Data Entry Form -->
        <section class="data-entry">
            <h2>üìù Add New Customer Query</h2>
            <div class="form-container">
                <form id="dataEntryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerName">Customer Name *</label>
                            <input type="text" id="customerName" required placeholder="Enter customer name">
                        </div>
                        <div class="form-group">
                            <label for="orderID">Order ID *</label>
                            <input type="text" id="orderID" required placeholder="e.g., ORD-12345">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="queryType">Query Type *</label>
                            <select id="queryType" required>
                                <option value="">Select type...</option>
                                <option value="Order Status">Order Status</option>
                                <option value="Delivery Time">Delivery Time</option>
                                <option value="Order Issue">Order Issue</option>
                                <option value="Product Inquiry">Product Inquiry</option>
                                <option value="Cancellation Request">Cancellation Request</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="status">Status *</label>
                            <select id="status" required>
                                <option value="IN PROGRESS">IN PROGRESS</option>
                                <option value="RESPONDED">RESPONDED</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="queryDetails">Query Details *</label>
                        <textarea id="queryDetails" required placeholder="Enter query details..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="response">Response</label>
                        <textarea id="response" placeholder="Enter response (optional)" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-submit">üíæ Submit Query</button>
                        <button type="reset" class="btn-reset">üîÑ Clear Form</button>
                    </div>
                </form>
            </div>
            
            <!-- Recent Entries -->
            <div class="recent-entries">
                <h3>üìã Recent Entries</h3>
                <div id="entriesList" class="entries-list"></div>
            </div>
        </section>

        <!-- KPI Metrics -->
        <section class="metrics">
            <h2>üìä Key Performance Indicators</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Wave Completion</h3>
                    <p class="metric-value" id="waveCompletion">95%</p>
                    <p class="metric-label">Target: 100% in 1 hour</p>
                </div>
                <div class="metric-card">
                    <h3>Employee Training</h3>
                    <p class="metric-value" id="employeeTraining">87%</p>
                    <p class="metric-label">Target: 100%</p>
                </div>
                <div class="metric-card">
                    <h3>Stock Replenishment</h3>
                    <p class="metric-value" id="stockReplenishment">2.5 hrs</p>
                    <p class="metric-label">Target: < 2 hours</p>
                </div>
                <div class="metric-card">
                    <h3>Quality Audit Rate</h3>
                    <p class="metric-value" id="qualityAudit">5%</p>
                    <p class="metric-label">Target: > 5%</p>
                </div>
                <div class="metric-card">
                    <h3>Picking Efficiency</h3>
                    <p class="metric-value" id="pickingEfficiency">92%</p>
                    <p class="metric-label">Target: > 95%</p>
                </div>
                <div class="metric-card">
                    <h3>Order Volume</h3>
                    <p class="metric-value" id="orderVolume">1,247</p>
                    <p class="metric-label">Today's Orders</p>
                </div>
                <div class="metric-card">
                    <h3>SLA Compliance</h3>
                    <p class="metric-value" id="slaCompliance">96%</p>
                    <p class="metric-label">Target: > 95%</p>
                </div>
                <div class="metric-card">
                    <h3>Inventory Accuracy</h3>
                    <p class="metric-value" id="inventoryAccuracy">98.5%</p>
                    <p class="metric-label">Target: > 99%</p>
                </div>
                <div class="metric-card">
                    <h3>System Uptime</h3>
                    <p class="metric-value" id="systemUptime">99.2%</p>
                    <p class="metric-label">Target: > 99%</p>
                </div>
                <div class="metric-card">
                    <h3>Active Employees</h3>
                    <p class="metric-value" id="activeEmployees">47</p>
                    <p class="metric-label">On Duty Now</p>
                </div>
                <div class="metric-card">
                    <h3>Pending Tasks</h3>
                    <p class="metric-value" id="pendingTasks">23</p>
                    <p class="metric-label">Requires Attention</p>
                </div>
            </div>
        </section>

        <!-- Checklist Section -->
        <section class="checklist">
            <h2>‚úÖ Operations Checklist</h2>
            <div class="checklist-grid">
                <div class="checklist-item">
                    <p>Check wave completion status</p>
                    <button class="btn-checklist" onclick="checkWaveStatus()">Check Status</button>
                    <span id="waveStatus" class="status-text"></span>
                </div>
                <div class="checklist-item">
                    <p>Verify employee training completion</p>
                    <button class="btn-checklist" onclick="verifyTraining()">Verify Training</button>
                    <span id="trainingStatus" class="status-text"></span>
                </div>
                <div class="checklist-item">
                    <p>Analyze stock replenishment delays</p>
                    <button class="btn-checklist" onclick="analyzeStock()">Analyze Issues</button>
                    <span id="stockStatus" class="status-text"></span>
                </div>
                <div class="checklist-item">
                    <p>Adjust quality audit rate</p>
                    <button class="btn-checklist" onclick="adjustQualityRate()">Adjust Rate</button>
                    <span id="qualityStatus" class="status-text"></span>
                </div>
            </div>
        </section>

        <!-- Insights Section -->
        <section class="insights">
            <h2>üí° Insights & Recommendations</h2>
            <div class="insight-cards">
                <div class="insight-card alert">
                    <h3>‚ö†Ô∏è Attention Required</h3>
                    <p>Stock replenishment is 25% over target time. Review process efficiency.</p>
                </div>
                <div class="insight-card success">
                    <h3>‚úÖ Performance Highlight</h3>
                    <p>SLA compliance maintained above target for 15 consecutive days.</p>
                </div>
                <div class="insight-card info">
                    <h3>‚ÑπÔ∏è Training Update</h3>
                    <p>13% of employees pending training completion. Schedule sessions this week.</p>
                </div>
            </div>
        </section>

        <footer>
            <p>Last Updated: <span id="lastUpdated">--</span></p>
            <p>Auto-refresh enabled | Data persisted in browser storage</p>
        </footer>
    </div>

    <script src="generate_excel.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
